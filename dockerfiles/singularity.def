Bootstrap: docker
From: rocker/ml-verse:4.2.0

%post
    wget https://raw.githubusercontent.com/Bioconductor/bioconductor_docker/RELEASE_3_15/bioc_scripts/install_bioc_sysdeps.sh
    sh install_bioc_sysdeps.sh
    rm install_bioc_sysdeps.sh

    wget https://raw.githubusercontent.com/Bioconductor/bioconductor_docker/RELEASE_3_15/bioc_scripts/install.R
    R -f install.R
    rm install.R
    
    # Install default & yihui TinyTex latex package sets to allow knit-to-PDF
    # (hopefully in most cases) without installation of additional LaTeX packages,
    # as /usr/local/texlive is read-only in the Singularity image
    # v0.38 is broken w/ CTAN 2022/04/21 (https://github.com/rstudio/tinytex/pull/364); need v0.39
    tlmgr update --self
    tlmgr install $(curl https://raw.githubusercontent.com/rstudio/tinytex/v0.39/tools/pkgs-custom.txt | tr '\n' ' ')
    tlmgr install $(curl https://raw.githubusercontent.com/rstudio/tinytex/v0.39/tools/pkgs-yihui.txt | tr '\n' ' ')

%labels
    Author nweeks@g.harvard.edu
